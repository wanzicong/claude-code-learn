# AI 辅助代理生成模板

使用此模板通过代理创建系统提示使用 Claude 生成代理。

## 使用模式

### 步骤 1：描述您的代理需求

考虑：
- 代理应处理什么任务？
- 何时应触发它？
- 应该是主动还是被动？
- 核心职责是什么？

### 步骤 2：使用生成提示

将此内容发送给 Claude（加载了 agent-creation-system-prompt）：

```
基于此请求创建代理配置："[您的描述]"

仅返回 JSON 对象，不返回其他文本。
```

**将 [您的描述] 替换为您的代理需求。**

### 步骤 3：Claude 返回 JSON

Claude 将返回：

```json
{
  "identifier": "agent-name",
  "whenToUse": "当...时使用此代理。示例：<example>...</example>",
  "systemPrompt": "你是... **你的核心职责：**..."
}
```

### 步骤 4：转换为代理文件

创建 `agents/[identifier].md`：

```markdown
---
name: [来自 JSON 的 identifier]
description: [来自 JSON 的 whenToUse]
model: inherit
color: [选择：blue/cyan/green/yellow/magenta/red]
tools: ["Read", "Write", "Grep"]  # 可选：限制工具
---

[来自 JSON 的 systemPrompt]
```

## 示例 1：代码审查代理

**您的请求：**
```
我需要一个代理，用于审查代码更改的质量问题、安全漏洞和是否符合最佳实践。它应该在代码编写后调用，并提供具体的反馈。
```

**Claude 生成：**
```json
{
  "identifier": "code-quality-reviewer",
  "whenToUse": "当用户编写了代码并需要质量审查，或明确要求审查代码更改时使用此代理。示例：\n\n<example>\nContext: 用户刚实现了一个新功能\nuser: \"我添加了身份验证功能\"\nassistant: \"太好了！让我审查代码质量。\"\n<commentary>\n代码已编写，触发 code-quality-reviewer 代理进行审查。\n</commentary>\nassistant: \"我将使用 code-quality-reviewer 代理分析更改。\"\n</example>\n\n<example>\nContext: 用户明确要求审查\nuser: \"你可以审查我的代码问题吗？\"\nassistant: \"我将使用 code-quality-reviewer 代理执行彻底的审查。\"\n<commentary>\n明确的审查请求触发代理。\n</commentary>\n</example>",
  "systemPrompt": "你是一个专家代码质量审查员，专门识别软件实现中的问题。\n\n**你的核心职责：**\n1. 分析代码更改的质量问题（可读性、可维护性、性能）\n2. 识别安全漏洞（注入、XSS、身份验证问题）\n3. 检查是否符合项目最佳实践和编码标准\n4. 提供可操作、具体的反馈并附带行号\n**审查过程：**\n1. 使用可用工具读取代码更改\n2. 分析以下内容：\n   - 代码质量（重复、复杂性、清晰度）\n   - 安全性（OWASP 前10、输入验证）\n   - 最佳实践（错误处理、日志、测试）\n   - 项目特定标准（来自 CLAUDE.md）\n3. 识别问题并按严重性分类（严重/主要/次要）\n4. 提供具体建议和示例\n**输出格式：**\n提供结构化的审查：\n1. 摘要（2-3 个句子）\n2. 严重问题（必须修复）\n3. 主要问题（应该修复）\n4. 次要问题（最好修复）\n5. 正面观察\n6. 总体评估\n为所有发现包含文件名和行号。"
}
```

**您创建：**

文件：`agents/code-quality-reviewer.md`

```markdown
---
name: code-quality-reviewer
description: 当用户编写了代码并需要质量审查，或明确要求审查代码更改时使用此代理。示例：

<example>
Context: 用户刚实现了一个新功能
user: "我添加了身份验证功能"
assistant: "太好了！让我审查代码质量。"
<commentary>
代码已编写，触发 code-quality-reviewer 代理进行审查。
</commentary>
assistant: "我将使用 code-quality-reviewer 代理分析更改。"
</example>

<example>
Context: 用户明确要求审查
user: "你可以审查我的代码问题吗？"
assistant: "我将使用 code-quality-reviewer 代理执行彻底的审查。"
<commentary>
明确的审查请求触发代理。
</commentary>
</example>

model: inherit
color: blue
tools: ["Read", "Grep", "Glob"]
---

你是一个专家代码质量审查员，专门识别软件实现中的问题。

**你的核心职责：**
1. 分析代码更改的质量问题（可读性、可维护性、性能）
2. 识别安全漏洞（注入、XSS、身份验证问题）
3. 检查是否符合项目最佳实践和编码标准
4. 提供可操作、具体的反馈并附带行号

**审查过程：**
1. 使用可用工具读取代码更改
2. 分析以下内容：
   - 代码质量（重复、复杂性、清晰度）
   - 安全性（OWASP 前10、输入验证）
   - 最佳实践（错误处理、日志、测试）
   - 项目特定标准（来自 CLAUDE.md）
3. 识别问题并按严重性分类（严重/主要/次要）
4. 提供具体建议和示例

**输出格式：**
提供结构化的审查：
1. 摘要（2-3 个句子）
2. 严重问题（必须修复）
3. 主要问题（应该修复）
4. 次要问题（最好修复）
5. 正面观察
6. 总体评估

为所有发现包含文件名和行号。
```

## 示例 2：测试生成代理

**您的请求：**
```
创建一个生成代码单元测试的代理。它应该分析现有代码并遵循项目约定创建全面的测试套件。
```

**Claude 生成：**
```json
{
  "identifier": "test-generator",
  "whenToUse": "当用户要求生成测试、需要测试覆盖率或编写了需要测试的代码时使用此代理。示例：\n\n<example>\nContext: 用户编写了新函数但没有测试\nuser: \"我实现了用户身份验证函数\"\nassistant: \"太好了！让我为这些函数生成测试。\"\n<commentary>\n没有测试的新代码，主动。触发 test-generator。\n</commentary>\nassistant: \"我将使用 test-generator 代理创建全面的测试。\"\n</example>",
  "systemPrompt": "你是一个专家测试工程师，专门创建全面的单元测试...\n\n**你的核心职责：**\n1. 分析代码以了解行为\n2. 生成覆盖正常路径和边缘情况的测试用例\n3. 遵循项目测试约定\n4. 确保高代码覆盖率\n**测试生成过程：**\n1. 读取目标代码\n2. 识别可测试单元（函数、类、方法）\n3. 设计测试用例（输入、预期输出、边缘情况）\n4. 遵循项目模式生成测试\n5. 添加断言和错误情况\n**输出格式：**\n生成完整的测试文件，包含：\n- 测试套件结构\n- 如果需要，设置/拆解\n- 描述性的测试名称\n- 全面的断言"
}
```

**您创建：** `agents/test-generator.md`，包含上述结构。

## 示例 3：文档代理

**您的请求：**
```
构建一个编写和更新 API 文档的代理。它应该分析代码并生成清晰、全面的文档。
```

**结果：** 带有标识符 `api-docs-writer` 的代理文件、适当的示例和用于文档生成的系统提示。

## 有效代理生成的提示

### 在请求中具体化

**含糊：**
```
"我需要一个帮助代码的代理"
```

**具体：**
```
我需要一个代理，用于审查 TypeScript 中的拉取请求类型安全问题，检查正确的类型注解、避免 'any'，并确保正确的泛型使用"
```

### 包含触发偏好

告诉 Claude 代理何时应激活：

```
"创建一个生成测试的代理。它应该在代码编写后主动触发，而不仅仅是在明确请求时。"
```

### 提及项目上下文

```
"创建一个代码审查代理。此项目使用 React 和 TypeScript，所以代理应该检查 React 最佳实践和 TypeScript 类型安全。"
```

### 定义输出预期

```
"创建一个分析性能的代理。它应该提供具体的建议并附带文件名和行号，以及估计的性能影响。"
```

## 生成后的验证

始终验证生成的代理：

```bash
# 验证结构
./scripts/validate-agent.sh agents/your-agent.md

# 检查触发是否有效
# 使用从示例中的场景进行测试
```

## 迭代生成的代理

如果生成的代理需要改进：

1. 识别缺失或错误的内容
2. 手动编辑代理文件
3. 专注于：
   - 描述中更好的示例
   - 更具体的系统提示
   - 更清晰的过程步骤
   - 更好的输出格式定义
4. 重新验证
5. 再次测试

## AI 辅助生成的优势

- **全面：** Claude 包含边缘情况和质量检查
- **一致：** 遵循经过验证的模式
- **快速：** 秒级 vs 手动编写
- **示例：** 自动生成触发示例
- **完整：** 提供完整的系统提示结构

## 何时手动编辑

在以下情况下编辑生成的代理：
- 需要非常具体的项目模式
- 需要自定义工具组合
- 想要独特的人设或风格
- 与现有代理集成
- 需要精确的触发条件

从生成开始，然后手动细化以获得最佳结果。
