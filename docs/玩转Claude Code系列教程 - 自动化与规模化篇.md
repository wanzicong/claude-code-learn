# ğŸ­ ç©è½¬ Claude Code ç³»åˆ—æ•™ç¨‹ â€” è‡ªåŠ¨åŒ–ä¸è§„æ¨¡åŒ–ç¯‡

> **ä¸€å¥è¯æ¦‚æ‹¬**ï¼šæœ¬ç¯‡è®²è§£å¦‚ä½•é€šè¿‡æ— å¤´æ¨¡å¼ã€å¹¶è¡Œä¼šè¯ã€CI/CD é›†æˆå’Œè„šæœ¬åŒ–ï¼Œå°† Claude Code ä»ä¸ªäººå·¥å…·æ‰©å±•ä¸ºå›¢é˜Ÿçº§ç”Ÿäº§åŠ›å¼•æ“ã€‚

---

## ä¸€ã€æ€»è¿°

å‰é¢å‡ ç¯‡æ•™ç¨‹èšç„¦äº"ä¸€ä¸ªäºº + ä¸€ä¸ª Claude"çš„åœºæ™¯ã€‚æœ¬ç¯‡å°†æ•™ä½ å¦‚ä½• **æ°´å¹³æ‰©å±•**ï¼Œè®© Claude Code åœ¨ä»¥ä¸‹åœºæ™¯ä¸­å‘æŒ¥æ›´å¤§ä»·å€¼ï¼š

- åœ¨ CI/CD ç®¡é“ä¸­è‡ªåŠ¨åŒ–ä»£ç å®¡æŸ¥
- å¹¶è¡Œè¿è¡Œå¤šä¸ª Claude ä¼šè¯å¤„ç†ä¸åŒä»»åŠ¡
- ç”¨è„šæœ¬æ‰¹é‡å¤„ç†æ–‡ä»¶è¿ç§»
- å°† Claude é›†æˆåˆ°ç°æœ‰çš„ Unix å·¥å…·é“¾ä¸­

---

## äºŒã€æ— å¤´æ¨¡å¼ï¼ˆHeadless Modeï¼‰

### ä»€ä¹ˆæ˜¯æ— å¤´æ¨¡å¼ï¼Ÿ

ä½¿ç”¨ `claude -p "æç¤º"` å¯ä»¥åœ¨æ²¡æœ‰äº¤äº’å¼ä¼šè¯çš„æƒ…å†µä¸‹è¿è¡Œ Claudeã€‚è¿™æ˜¯å°† Claude é›†æˆåˆ°è„šæœ¬ã€CI ç®¡é“å’Œè‡ªåŠ¨åŒ–å·¥ä½œæµçš„åŸºç¡€ã€‚

### åŸºæœ¬ç”¨æ³•

```bash
# å•æ¬¡æŸ¥è¯¢
claude -p "è§£é‡Šè¿™ä¸ªé¡¹ç›®æ˜¯åšä»€ä¹ˆçš„"

# ç»“æ„åŒ–è¾“å‡ºï¼ˆç”¨äºè„šæœ¬è§£æï¼‰
claude -p "åˆ—å‡ºæ‰€æœ‰ API ç«¯ç‚¹" --output-format json

# æµå¼è¾“å‡ºï¼ˆå®æ—¶å¤„ç†ï¼‰
claude -p "åˆ†æè¿™ä¸ªæ—¥å¿—æ–‡ä»¶" --output-format stream-json
```

### ç®¡é“æ“ä½œ

```bash
# å°†æ•°æ®é€šè¿‡ç®¡é“ä¼ ç»™ Claude
cat build-error.txt | claude -p "ç®€æ´åœ°è§£é‡Šè¿™ä¸ªæ„å»ºé”™è¯¯çš„æ ¹æœ¬åŸå› " > output.txt

# ä¸å…¶ä»– Unix å·¥å…·ç»„åˆ
cat data.csv | claude -p "åˆ†æè¿™äº›æ•°æ®å¹¶æ‰¾å‡ºå¼‚å¸¸" --output-format json | jq '.result'
```

### è¾“å‡ºæ ¼å¼

| æ ¼å¼ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|---------|
| `text`ï¼ˆé»˜è®¤ï¼‰ | çº¯æ–‡æœ¬å“åº” | ç®€å•é›†æˆ |
| `json` | å¸¦å…ƒæ•°æ®çš„ JSON æ•°ç»„ | éœ€è¦å®Œæ•´å¯¹è¯æ—¥å¿— |
| `stream-json` | å®æ—¶ JSON å¯¹è±¡æµ | å®æ—¶å¤„ç† |

---

## ä¸‰ã€ä½œä¸º Unix å·¥å…·ä½¿ç”¨

### æ·»åŠ åˆ°æ„å»ºè„šæœ¬

```json
// package.json
{
  "scripts": {
    "lint:claude": "claude -p 'ä½ æ˜¯ä¸€ä¸ª linterã€‚è¯·æŸ¥çœ‹ä¸ main åˆ†æ”¯çš„å·®å¼‚ï¼ŒæŠ¥å‘Šä¸æ‹¼å†™é”™è¯¯ç›¸å…³çš„é—®é¢˜ã€‚æ¯è¡ŒæŠ¥å‘Šæ–‡ä»¶åå’Œè¡Œå·ï¼Œç¬¬äºŒè¡Œæè¿°é—®é¢˜ã€‚ä¸è¦è¿”å›å…¶ä»–æ–‡æœ¬ã€‚'"
  }
}
```

### ä½œä¸ºä»£ç å®¡æŸ¥å·¥å…·

```bash
# åœ¨ CI ä¸­è‡ªåŠ¨å®¡æŸ¥ä»£ç 
git diff main | claude -p "å®¡æŸ¥è¿™äº›ä»£ç æ›´æ”¹ï¼Œå…³æ³¨å®‰å…¨é—®é¢˜å’Œæ€§èƒ½é—®é¢˜" > review.md
```

### ç›‘æ§å’Œå‘Šè­¦

```bash
# ç›‘æ§æ—¥å¿—å¹¶åœ¨å‘ç°å¼‚å¸¸æ—¶é€šçŸ¥
tail -f app.log | claude -p "å¦‚æœå‘ç°å¼‚å¸¸æ¨¡å¼å°±è¾“å‡ºå‘Šè­¦ä¿¡æ¯"
```

---

## å››ã€å¹¶è¡Œä¼šè¯

### æ–¹å¼ä¸€ï¼šGit Worktreesï¼ˆæœ¬åœ°å¹¶è¡Œï¼‰

Git worktrees å…è®¸ä½ ä»åŒä¸€ä»“åº“æ£€å‡ºå¤šä¸ªåˆ†æ”¯åˆ°ä¸åŒç›®å½•ï¼Œæ¯ä¸ªç›®å½•æœ‰ç‹¬ç«‹çš„å·¥ä½œæ–‡ä»¶ã€‚

```bash
# åˆ›å»ºæ–°çš„ worktree
git worktree add ../project-feature-a -b feature-a
git worktree add ../project-bugfix bugfix-123

# åœ¨æ¯ä¸ª worktree ä¸­è¿è¡Œ Claude
cd ../project-feature-a && claude    # ç»ˆç«¯ 1
cd ../project-bugfix && claude       # ç»ˆç«¯ 2

# ç®¡ç† worktrees
git worktree list                    # åˆ—å‡ºæ‰€æœ‰ worktrees
git worktree remove ../project-feature-a  # å®Œæˆåç§»é™¤
```

**ä¼˜åŠ¿ï¼š**
- æ¯ä¸ª worktree æœ‰ç‹¬ç«‹çš„æ–‡ä»¶çŠ¶æ€
- Claude å®ä¾‹ä¹‹é—´äº’ä¸å¹²æ‰°
- æ‰€æœ‰ worktrees å…±äº« Git å†å²å’Œè¿œç¨‹è¿æ¥

### æ–¹å¼äºŒï¼šæ¡Œé¢åº”ç”¨ï¼ˆå¯è§†åŒ–ç®¡ç†ï¼‰

Claude Code æ¡Œé¢åº”ç”¨æ”¯æŒå¯è§†åŒ–ç®¡ç†å¤šä¸ªæœ¬åœ°ä¼šè¯ï¼Œæ¯ä¸ªä¼šè¯æœ‰ç‹¬ç«‹çš„ worktreeã€‚

### æ–¹å¼ä¸‰ï¼šç½‘é¡µç‰ˆï¼ˆäº‘ç«¯å¹¶è¡Œï¼‰

åœ¨ claude.ai/code ä¸Šè¿è¡Œï¼Œä½¿ç”¨ Anthropic çš„å®‰å…¨äº‘åŸºç¡€è®¾æ–½ï¼Œåœ¨éš”ç¦»çš„è™šæ‹Ÿæœºä¸­æ‰§è¡Œã€‚

### æ–¹å¼å››ï¼šä»£ç†å›¢é˜Ÿï¼ˆAgent Teamsï¼‰

è‡ªåŠ¨åè°ƒå¤šä¸ªä¼šè¯ï¼Œæ”¯æŒå…±äº«ä»»åŠ¡ã€æ¶ˆæ¯ä¼ é€’å’Œå›¢é˜Ÿé¢†å¯¼ã€‚

### å†™è€…/å®¡æŸ¥è€…æ¨¡å¼

åˆ©ç”¨å¹¶è¡Œä¼šè¯å®ç°è´¨é‡ä¿éšœå·¥ä½œæµï¼š

| ä¼šè¯ Aï¼ˆå†™è€…ï¼‰ | ä¼šè¯ Bï¼ˆå®¡æŸ¥è€…ï¼‰ |
|---------------|----------------|
| `å®ç° API ç«¯ç‚¹çš„é€Ÿç‡é™åˆ¶å™¨` | |
| | `å®¡æŸ¥ @src/middleware/rateLimiter.ts ä¸­çš„é€Ÿç‡é™åˆ¶å™¨å®ç°ã€‚æŸ¥æ‰¾è¾¹ç•Œæƒ…å†µã€ç«æ€æ¡ä»¶å’Œä¸ç°æœ‰ä¸­é—´ä»¶æ¨¡å¼çš„ä¸€è‡´æ€§ã€‚` |
| `è¿™æ˜¯å®¡æŸ¥åé¦ˆï¼š[ä¼šè¯ B è¾“å‡º]ã€‚è§£å†³è¿™äº›é—®é¢˜ã€‚` | |

---

## äº”ã€æ‰¹é‡å¤„ç† â€” æ‰‡å‡ºæ¨¡å¼

### å¤§è§„æ¨¡æ–‡ä»¶è¿ç§»

```bash
# ç¬¬ä¸€æ­¥ï¼šè®© Claude ç”Ÿæˆä»»åŠ¡åˆ—è¡¨
claude -p "åˆ—å‡ºæ‰€æœ‰éœ€è¦ä» React è¿ç§»åˆ° Vue çš„æ–‡ä»¶" > files.txt

# ç¬¬äºŒæ­¥ï¼šå¾ªç¯å¤„ç†æ¯ä¸ªæ–‡ä»¶
for file in $(cat files.txt); do
  claude -p "å°† $file ä» React è¿ç§»åˆ° Vueã€‚è¿”å› OK æˆ– FAILã€‚" \
    --allowedTools "Edit,Bash(git commit *)"
done

# ç¬¬ä¸‰æ­¥ï¼šå…ˆåœ¨å‡ ä¸ªæ–‡ä»¶ä¸Šæµ‹è¯•ï¼Œç„¶åå¤§è§„æ¨¡è¿è¡Œ
```

### é›†æˆåˆ°æ•°æ®ç®¡é“

```bash
# Claude ä½œä¸ºæ•°æ®å¤„ç†ç®¡é“çš„ä¸€ç¯
claude -p "<ä½ çš„æç¤º>" --output-format json | your_command
```

### é¢„ç®—æ§åˆ¶

```bash
# é™åˆ¶ API è°ƒç”¨èŠ±è´¹
claude -p "åˆ†æä»£ç åº“" --max-budget-usd 5.00

# é™åˆ¶æ™ºèƒ½ä½“è½®æ¬¡
claude -p "ä¿®å¤æ‰€æœ‰ lint é”™è¯¯" --max-turns 10
```

---

## å…­ã€CI/CD é›†æˆ

### GitHub Actions

Claude Code å¯ä»¥ç›´æ¥é›†æˆåˆ° GitHub Actions ä¸­ï¼Œå®ç°ï¼š

- è‡ªåŠ¨ä»£ç å®¡æŸ¥
- Issue åˆ†ç±»
- PR æè¿°ç”Ÿæˆ
- ä½¿ç”¨ `@claude` æåŠè§¦å‘å·¥ä½œæµ

### GitLab CI/CD

æ”¯æŒäº‹ä»¶é©±åŠ¨çš„è‡ªåŠ¨åŒ–ï¼š

- Merge Request è‡ªåŠ¨å®¡æŸ¥
- Issue è‡ªåŠ¨å¤„ç†
- ä»£ç è´¨é‡æ£€æŸ¥

### é€šç”¨ CI é›†æˆæ¨¡å¼

```bash
# åœ¨ CI ä¸­è¿è¡Œ Claudeï¼ˆè·³è¿‡æƒé™æ£€æŸ¥ï¼‰
claude --dangerously-skip-permissions -p "æ£€æŸ¥ä»£ç ä¸­çš„å®‰å…¨æ¼æ´å¹¶ç”ŸæˆæŠ¥å‘Š"

# å¸¦ç»“æ„åŒ–è¾“å‡º
claude -p "åˆ†ææµ‹è¯•è¦†ç›–ç‡" --output-format json > coverage-analysis.json
```

> âš ï¸ `--dangerously-skip-permissions` ä¼šè·³è¿‡æ‰€æœ‰æƒé™æ£€æŸ¥ã€‚ä»…åœ¨æ²¡æœ‰äº’è”ç½‘è®¿é—®çš„æ²™ç®±/å®¹å™¨ä¸­ä½¿ç”¨ã€‚

---

## ä¸ƒã€å®‰å…¨çš„è‡ªä¸»æ¨¡å¼

### æ²™ç®±æ¨¡å¼

ä½¿ç”¨ `/sandbox` å¯ç”¨æ“ä½œç³»ç»Ÿçº§éš”ç¦»ï¼Œåœ¨å®šä¹‰çš„è¾¹ç•Œå†…è®© Claude æ›´è‡ªç”±åœ°å·¥ä½œï¼š

- é™åˆ¶æ–‡ä»¶ç³»ç»Ÿè®¿é—®èŒƒå›´
- é™åˆ¶ç½‘ç»œè®¿é—®
- æ¯”å®Œå…¨è·³è¿‡æƒé™æ›´å®‰å…¨

### æƒé™ç™½åå•

å¯¹äºå¯ä¿¡å‘½ä»¤ï¼Œé¢„å…ˆé…ç½®å…è®¸åˆ—è¡¨ï¼š

```json
{
  "permissions": {
    "allow": [
      "Bash(npm run lint)",
      "Bash(npm run test *)",
      "Bash(git status)",
      "Bash(git diff *)",
      "Bash(git commit *)"
    ]
  }
}
```

---

## å…«ã€äº‘å¹³å°éƒ¨ç½²

Claude Code æ”¯æŒå¤šç§ä¼ä¸šçº§äº‘å¹³å°ï¼š

| å¹³å° | è¯´æ˜ |
|------|------|
| **Amazon Bedrock** | AWS æ‰˜ç®¡çš„ Claude API |
| **Google Vertex AI** | GCP æ‰˜ç®¡çš„ Claude API |
| **Microsoft Foundry** | Azure æ‰˜ç®¡çš„ Claude API |

é…ç½®æ–¹å¼å‚è€ƒå„å¹³å°çš„å®˜æ–¹æ–‡æ¡£ã€‚

---

## ä¹ã€æˆæœ¬ç®¡ç†

### ç›‘æ§ä½¿ç”¨é‡

```bash
# æŸ¥çœ‹ä¸Šä¸‹æ–‡ä½¿ç”¨æƒ…å†µ
> /context

# æŸ¥çœ‹ MCP æœåŠ¡å™¨çš„ä¸Šä¸‹æ–‡æˆæœ¬
> /mcp
```

### å‡å°‘ Token ä½¿ç”¨çš„ç­–ç•¥

| ç­–ç•¥ | æ–¹æ³• |
|------|------|
| åŠæ—¶æ¸…ç†ä¸Šä¸‹æ–‡ | ä¸ç›¸å…³ä»»åŠ¡ä¹‹é—´ä½¿ç”¨ `/clear` |
| ä½¿ç”¨å­ä»£ç† | è°ƒç ”ä»»åŠ¡å§”æ‰˜ç»™å­ä»£ç†ï¼Œä¸æ±¡æŸ“ä¸»ä¸Šä¸‹æ–‡ |
| ç²¾ç®€ CLAUDE.md | åˆ é™¤ä¸å¿…è¦çš„æŒ‡ä»¤ |
| è°ƒæ•´åŠªåŠ›çº§åˆ« | ç®€å•ä»»åŠ¡ä½¿ç”¨ `low` åŠªåŠ›çº§åˆ« |
| é™åˆ¶é¢„ç®— | ä½¿ç”¨ `--max-budget-usd` æ§åˆ¶èŠ±è´¹ |

---

## åã€æ€»ç»“

æœ¬ç¯‡ä»‹ç»äº†å°† Claude Code ä»ä¸ªäººå·¥å…·æ‰©å±•ä¸ºå›¢é˜Ÿçº§ç”Ÿäº§åŠ›å¼•æ“çš„æ–¹æ³•ï¼š

| èƒ½åŠ› | æ ¸å¿ƒå‘½ä»¤/æ–¹æ³• |
|------|-------------|
| **æ— å¤´æ¨¡å¼** | `claude -p "æç¤º"` |
| **ç®¡é“æ“ä½œ** | `cat file \| claude -p "åˆ†æ"` |
| **å¹¶è¡Œä¼šè¯** | Git worktrees + å¤šç»ˆç«¯ |
| **æ‰¹é‡å¤„ç†** | `for file in ...; do claude -p ...; done` |
| **CI/CD é›†æˆ** | GitHub Actions / GitLab CI/CD |
| **è¾“å‡ºæ ¼å¼** | `--output-format text/json/stream-json` |
| **é¢„ç®—æ§åˆ¶** | `--max-budget-usd` / `--max-turns` |

**æ ¸å¿ƒç†å¿µ**ï¼šClaude Code éµå¾ª Unix å“²å­¦â€”â€”å¯ç»„åˆã€å¯è„šæœ¬åŒ–ã€å¯ç®¡é“åŒ–ã€‚ä¸€æ—¦ä½ æŒæ¡äº†è¿™äº›æ¨¡å¼ï¼Œå°±èƒ½å°† AI ç¼–ç¨‹èƒ½åŠ›æ³¨å…¥åˆ°ä»»ä½•è‡ªåŠ¨åŒ–å·¥ä½œæµä¸­ã€‚

æ¥ä¸‹æ¥è¯·é˜…è¯»æœ€åä¸€ç¯‡ **[æœ€ä½³å®è·µä¸é¿å‘æŒ‡å—]**ï¼Œå­¦ä¹ å¦‚ä½•é¿å…å¸¸è§é™·é˜±å¹¶æœ€å¤§åŒ– Claude Code çš„æ•ˆæœï¼

---

> ğŸ“š **å‚è€ƒèµ„æ–™**ï¼š[æ— å¤´æ¨¡å¼](https://code.claude.com/docs/en/headless) | [GitHub Actions](https://code.claude.com/docs/en/github-actions) | [æˆæœ¬ç®¡ç†](https://code.claude.com/docs/en/costs)
